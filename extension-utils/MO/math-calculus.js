/**
 * Minified by jsDelivr using Terser v5.13.1.
 * Original file: /npm/nerdamer@1.1.13/Calculus.js
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
if("undefined"!=typeof module&&void 0===nerdamer){var nerdamer=require("./nerdamer.core.js");require("./Algebra.js")}!function(){"use strict";var e=nerdamer.getCore(),i=e.PARSER,r=e.Frac,n=e.Settings,t=e.Utils.isSymbol,a=e.groups.FN,s=e.Symbol,o=e.Utils.text,l=e.Utils.inBrackets,p=e.Utils.isInt,u=e.Utils.format,c=e.Utils.even,f=e.Utils.evaluate,g=e.groups.N,m=e.groups.S,w=(a=e.groups.FN,e.groups.PL),d=e.groups.CP,v=e.groups.CB,y=e.groups.EX,h=e.groups.P,b=n.LOG,L="abs",_="sqrt",U="sin",S="cos",k="tan",q="sec",x="csc",T="cot",C="asin",N="acos",I="atan",M="asec",A="acsc",E="acot",F="sinh",O="cosh",R="tanh",G="csch",V="sech",P="coth",D="asech",B="acsch",H="acoth";function Q(e){this.message=e||""}Q.prototype=new Error,s.prototype.hasIntegral=function(){return this.containsFunction("integrate")},s.prototype.fnTransform=function(){if(this.group!==a)return this;var e,r=this.args[0],n=new s(this.multiplier),t=this.clone().toUnitMultiplier();if(this.isLinear())switch(this.fname){case F:e=i.parse(u("(e^({0})-e^(-({0})))/2",r));break;case O:e=i.parse(u("(e^({0})+e^(-({0})))/2",r));break;case R:e=i.parse(u("(e^({0})-e^(-({0})))/(e^({0})+e^(-({0})))",r));break;case k:e=i.parse(u("sin({0})/cos({0})",r));break;case x:e=i.parse(u("1/sin({0})",r));break;case q:e=i.parse(u("1/cos({0})",r));break;default:e=t}else if(this.power.equals(2))switch(this.fname){case U:e=i.parse(u("1/2-cos(2*({0}))/2",r));break;case S:e=i.parse(u("1/2+cos(2*({0}))/2",r));break;case k:e=i.parse(u("sin({0})^2/cos({0})^2",r));break;case O:e=i.parse(u("1/2+cosh(2*({0}))/2",r));break;case F:e=i.parse(u("-1/2+cosh(2*({0}))/2",r));break;case R:e=i.parse(u("(1+cosh(2*({0})))/(-1+cosh(2*({0})))",r));break;case q:e=i.parse(u("(1-cos(2*({0})))/(1+cos(2*({0})))+1",r));break;default:e=t}else if(this.fname===q)e=i.parse(u("1/cos({0})^({1})",this.args[0],this.power));else if(this.fname===x)e=i.parse(u("1/sin({0})^({1})",this.args[0],this.power));else if(this.fname===k)e=this.power.lessThan(0)?i.parse(u("cos({0})^(-({1}))/sin({0})^({1})",this.args[0],this.power.negate())):i.parse(u("sin({0})^({1})/cos({0})^({1})",this.args[0],this.power));else if(this.fname===U&&this.power.lessThan(0))e=i.parse(u("csc({0})^(-({1}))",this.args[0],this.power.negate()));else if(this.fname===S&&this.power.lessThan(0))e=i.parse(u("sec({0})^(-({1}))",this.args[0],this.power.negate()));else if(this.fname===U&&this.power.equals(3))e=i.parse(u("(3*sin({0})-sin(3*({0})))/4",this.args[0]));else if(this.fname===S&&this.power.equals(3))e=i.parse(u("(cos(3*({0}))+3*cos({0}))/4",this.args[0]));else if(this.fname!==S&&this.fname!==U||!c(this.power))e=t;else{var o=this.power/2,l=i.pow(this.clone().toLinear(),i.parse(2)).fnTransform(),p=i.expand(i.pow(l,i.parse(o)));e=new s(0),p.each((function(r){var n=r.fnTransform();e=i.add(e,n)}),!0)}return i.multiply(e,n)},s.prototype.hasTrig=function(){if(this.isConstant(!0)||this.group===m)return!1;if(this.fname&&(e.Utils.in_trig(this.fname)||e.Utils.in_inverse_trig(this.fname)))return!0;if(this.symbols)for(var i in this.symbols)if(this.symbols[i].hasTrig())return!0;return!1},e.Expression.prototype.hasIntegral=function(){return this.symbol.hasIntegral()},e.Utils.toCommonDenominator=function(r){if(r.isComposite()&&r.isLinear()){var n=new s(r.multiplier),t=new s(1),a=new s(0);return r.each((function(e){t=i.multiply(t,e.getDenom())}),!0),r.each((function(e){var r=e.getNum(),n=e.getDenom(),s=i.multiply(r,i.divide(t.clone(),n));a=i.add(a,s)})),i.multiply(n,e.Algebra.divide(i.expand(a),i.expand(t)))}return r},e.Utils.in_inverse_trig=function(e){return-1!==[C,N,I,A,M,E].indexOf(e)},e.Utils.in_trig=function(e){return-1!==[S,U,k,q,x,T].indexOf(e)},e.Utils.in_htrig=function(e){return-1!==[F,O,R,B,D,H].indexOf(e)},e.Matrix.jacobian=function(i,r){var n=new e.Matrix;return r||(r=e.Utils.arrayGetVariables(i)),r.forEach((function(r,t){i.forEach((function(i,a){var s=e.Calculus.diff(i.clone(),r);n.set(a,t,s)}))})),n},e.Matrix.prototype.max=function(){var e=new s(0);return this.each((function(i){var r=i.abs();r.gt(e)&&(e=r)})),e},e.Matrix.cMatrix=function(r,n){var t=new e.Matrix;return n.forEach((function(e,n){t.set(n,0,i.parse(r))})),t};var j=e.Utils.all_functions=function(e){for(var i=0,r=e.length;i<r;i++)if(e[i].group!==a)return!1;return!0},X=e.Utils.cosAsinBtranform=function(e,r){var n,t;return n=e.args[0],t=r.args[0],i.parse(u("(sin(({0})+({1}))-sin(({0})-({1})))/2",n,t))},Z=e.Utils.cosAsinAtranform=function(e,r){return 1!==Number(r.power)?i.multiply(e,r):(n=e.args[0],i.parse(u("(sin(2*({0})))/2",n)));var n},z=e.Utils.cosAsinBtranform=function(e,r){var n,t;return n=e.args[0],t=r.args[0],i.parse(u("(cos(({0})+({1}))-cos(({0})-({1})))/2",n,t))},J=e.Utils.trigTransform=function(e){for(var r,n,t={},o=new s(1),l=0,p=e.length;l<p;l++)if((r=e[l]).group===a){var u=r.fname;u===S&&t.sin?(n=t.sin.args[0].toString()!==r.args[0].toString()?X(r,t.sin):Z(r,t.sin),delete t.sin,o=i.multiply(o,n)):u===U&&t.cos?(n=t.cos.args[0].toString()!==r.args[0].toString()?X(r,t.cos):Z(r,t.cos),delete t.cos,o=i.multiply(o,n)):u===U&&t.sin?(t.sin.args[0].toString()!==r.args[0].toString()?(n=z(r,t.sin),delete t.sin):(n=i.multiply(r,t.sin),delete t.sin),o=n):t[u]=r}else o=i.multiply(o,r);for(var c in t)o=i.multiply(o,t[c]);return o};e.Settings.integration_depth=10,e.Settings.max_lim_depth=10;var K=e.Calculus={version:"1.4.6",sum:function(r,n,t,a){if(n.group!==e.groups.S)throw new e.exceptions.NerdamerTypeError("Index must be symbol. "+o(n)+" provided");var l;if(n=n.value,e.Utils.isNumericSymbol(t)&&e.Utils.isNumericSymbol(a)){var p=a-t<200?"":"PARSE2NUMBER";t=Number(t),a=Number(a),l=e.Utils.block(p,(function(){for(var o=r.text(),l={"~":!0},p=new e.Symbol(0),u=t;u<=a;u++){l[n]=new s(u);var c=i.parse(o,l);p=i.add(p,c)}return p}))}else l=i.symfunction("sum",arguments);return l},product:function(r,n,t,a){if(n.group!==e.groups.S)throw new e.exceptions.NerdamerTypeError("Index must be symbol. "+o(n)+" provided");var l;if(n=n.value,e.Utils.isNumericSymbol(t)&&e.Utils.isNumericSymbol(a)){var p=a-t<200?"":"PARSE2NUMBER";l=e.Utils.block(p,(function(){t=Number(t),a=Number(a.multiplier);for(var o=r.text(),l={},p=new e.Symbol(1),u=t;u<=a;u++)l[n]=new s(u),p=i.multiply(p,i.parse(o,l));return p}))}else l=i.symfunction("product",arguments);return l},diff:function(p,c,f){if(e.Utils.isVector(p)){var F=new e.Vector([]);return p.each((function(e){F.elements.push(K.diff(e,c,f))})),F}if(e.Utils.isMatrix(p)){var O=new e.Matrix;return p.each((function(e,i,r){O.set(i,r,K.diff(e,c,f))})),O}var Q=t(c)?c.text():c;if(f=t(f)?f.multiplier:f||1,void 0===Q&&(Q=e.Utils.variables(p)[0]),p.group===a&&p.fname===_){var j=p.args[0],X=p.power.clone();j.group===g&&j.group===h||(j.power=t(j.power)?i.multiply(j.power,i.multiply(new s(.5)),X):j.power.multiply(new r(.5)).multiply(X),j.multiplier=j.multiplier.multiply(p.multiplier)),p=j}if(p.group!==a||t(p.power))p=W(p);else{var Z=W(i.parse(p)),z=K.diff(p.args[0].clone(),Q);p=i.multiply(Z,z)}return f>1&&(f--,p=K.diff(p,c,f)),p;function J(e){return(e.value===Q||e.contains(Q,!0))&&(e.multiplier=e.multiplier.multiply(e.power),e.power=e.power.subtract(new r(1)),e.power.equals(0)&&(e=s(e.multiplier))),e}function W(e){var p,f,_=e.group;if(_===g||_===m&&e.value!==Q||_===h)e=s(0);else if(_===m)e=J(e);else{if(_===v){var F=e.multiplier.clone();e.toUnitMultiplier();var O=i.multiply(function(e){for(var r=e.collectSymbols(),n=new s(0),t=r.length,a=0;a<t;a++){for(var o=K.diff(r[a].clone(),Q),l=0;l<t;l++)a!==l&&(o=i.multiply(o,r[l].clone()));n=i.add(n,o)}return n}(e),J(e));return O.multiplier=O.multiplier.multiply(F),O}if(_===a&&e.power.equals(1))switch(e.fname){case b:f=e.clone(),(e=e.args[0].clone()).power=e.power.negate(),e.multiplier=f.multiplier.divide(e.multiplier);break;case S:e.fname=U,e.multiplier.negate();break;case U:e.fname=S;break;case k:e.fname=q,e.power=new r(2);break;case q:e=Y(e,k);break;case x:e=Y(e,"-cot");break;case T:e.fname=x,e.multiplier.negate(),e.power=new r(2);break;case C:e=i.parse("(sqrt(1-("+o(e.args[0])+")^2))^(-1)");break;case N:e=i.parse("-(sqrt(1-("+o(e.args[0])+")^2))^(-1)");break;case I:e=i.parse("(1+("+o(e.args[0])+")^2)^(-1)");break;case L:F=e.multiplier.clone(),e.toUnitMultiplier(),(p=e.args[0].clone()).toUnitMultiplier(),(e=i.parse(l(o(e.args[0]))+"/abs"+l(o(p)))).multiplier=F;break;case"parens":e=s(1);break;case"cosh":e.fname="sinh";break;case"sinh":e.fname="cosh";break;case R:e.fname=V,e.power=new r(2);break;case V:e=Y(e,"-tanh");break;case G:var j=String(e.args[0]);return i.parse("-coth("+j+")*csch("+j+")");case P:j=String(e.args[0]);return i.parse("-csch("+j+")^2");case"asinh":e=i.parse("(sqrt(1+("+o(e.args[0])+")^2))^(-1)");break;case"acosh":e=i.parse("(sqrt(-1+("+o(e.args[0])+")^2))^(-1)");break;case"atanh":e=i.parse("(1-("+o(e.args[0])+")^2)^(-1)");break;case D:j=String(e.args[0]);e=i.parse("-1/(sqrt(1/("+j+")^2-1)*("+j+")^2)");break;case H:e=i.parse("-1/(("+e.args[0]+")^2-1)");break;case B:j=String(e.args[0]);e=i.parse("-1/(sqrt(1/("+j+")^2+1)*("+j+")^2)");break;case M:j=String(e.args[0]);e=i.parse("1/(sqrt(1-1/("+j+")^2)*("+j+")^2)");break;case A:j=String(e.args[0]);e=i.parse("-1/(sqrt(1-1/("+j+")^2)*("+j+")^2)");break;case E:e=i.parse("-1/(("+e.args[0]+")^2+1)");break;case"S":j=String(e.args[0]);e=i.parse("sin((pi*("+j+")^2)/2)");break;case"C":j=String(e.args[0]);e=i.parse("cos((pi*("+j+")^2)/2)");break;case"Si":j=e.args[0];e=i.parse("sin("+j+")/("+j+")");break;case"Shi":j=e.args[0];e=i.parse("sinh("+j+")/("+j+")");break;case"Ci":j=e.args[0];e=i.parse("cos("+j+")/("+j+")");break;case"Chi":j=e.args[0];e=i.parse("cosh("+j+")/("+j+")");break;case"Ei":j=e.args[0];e=i.parse("e^("+j+")/("+j+")");break;case"Li":j=e.args[0];e=i.parse("1/"+n.LOG+"("+j+")");break;case"erf":e=i.parse("(2*e^(-("+e.args[0]+")^2))/sqrt(pi)");break;case"atan2":var X=String(e.args[0]),Z=String(e.args[1]);e=i.parse("("+Z+")/(("+Z+")^2+("+X+")^2)");break;case"sign":e=new s(0);break;case"sinc":e=i.parse(u("(({0})*cos({0})-sin({0}))*({0})^(-2)",e.args[0]));break;case n.LOG10:e=i.parse("1/(("+e.args[0]+")*"+n.LOG+"(10))");break;default:e=i.symfunction("diff",[e,c])}else if(_===y||_===a&&t(e.power)){var z;z=_===y?e.value:_===a&&e.contains(Q)?e.fname+l(o(e.args[0])):e.value+l(o(e.args[0])),i.multiply(i.parse(b+l(z)),e.power.clone()),p=K.diff(i.multiply(i.parse(b+l(z)),e.power.clone()),Q),e=i.multiply(e,p)}else if(_!==a||e.power.equals(1)){if(_===d||_===w){var $=e.clone(),ee=new s(0);for(var ie in e.symbols)ee=i.add(ee,K.diff(e.symbols[ie].clone(),Q));e=i.multiply(J($),ee)}}else(p=e.clone()).toLinear(),p.toUnitMultiplier(),e=i.multiply(J(e.clone()),W(p))}return e.updateHash(),e}function Y(e,r,n){return i.multiply(e,i.parse(r+l(n||o(e.args[0]))))}},integration:{u_substitution:function(r,n){function t(e,r,t){var a=K.diff(r,n),s=t?t(e,r):i.divide(e.clone(),a);return s.contains(n,!0)?null:s}function o(e,r){var n=K.integrate(i.symfunction(e,[new s(g)]),g,0);return(n=n.sub(new s(g),r)).updateHash(),n}var l,p=r[0].clone(),u=r[1].clone(),c=p.group,f=u.group,g="__u__";if(c===a&&f!==a){if(l=t(u,(m=p.args[0]).clone()))return i.multiply(l,o(p.fname,m));if(l=t(u,p))return K.integration.poly_integrate(p)}else if(f===a&&c!==a){var m;if(l=t(p,(m=u.args[0]).clone()))return i.multiply(l,o(u.fname,m))}else if(c===a&&f===a){if(l=t(p.clone(),u.clone()))return i.multiply(K.integration.poly_integrate(u),l);if(l=t(u.clone(),p.clone()))return i.multiply(K.integration.poly_integrate(u),l)}else{if(c===y&&f!==y){if(!(l=t(u,(_=p.power).clone()))){var w=K.integration.decompose_arg(_.clone(),n),d=K.diff(w[2].clone(),n),v=K.integration.decompose_arg(d.clone(),n);if(i.multiply(w[1],v[1]).power.equals(u.power)){var h=i.divide(w[0].clone(),v[0].clone()),b=i.multiply(h.clone(),i.pow(new s(p.value),i.multiply(w[0],new s(g))));return b=i.multiply(b,new s(g)),K.integration.by_parts(b,g,0,{}).sub(g,w[1].clone())}}var L=K.integrate(p.sub(_.clone(),new s(g)),g,0);return i.multiply(L.sub(new s(g),_),l)}if(f===y&&c!==y){var _;l=t(p,(_=u.power).clone());L=K.integrate(u.sub(_,new s(g)),g,0);return i.multiply(L.sub(new s(g),_),l)}if(p.isComposite()||u.isComposite()){var U=function(r,t){var a=K.diff(t,n),s=e.Algebra.Factor.factor(r),o=e.Algebra.Factor.factor(a);return i.divide(s,o)},S=p.isComposite()?p.clone().toLinear():p.clone(),k=u.isComposite()?u.clone().toLinear():u.clone();if(l=t(S.clone(),k.clone(),U))return i.multiply(K.integration.poly_integrate(u),l);if(l=t(k.clone(),S.clone(),U))return i.multiply(K.integration.poly_integrate(p),l)}}},poly_integrate:function(e){var r=e.power.toString(),n=e.multiplier.toDecimal(),t=e.toUnitMultiplier().toLinear();return-1===Number(r)?i.multiply(new s(n),i.symfunction(b,[t])):i.parse(u("({0})*({1})^(({2})+1)/(({2})+1)",n,t,r))},stop:function(i){throw i=i||"Unable to compute integral!",e.Utils.warn(i),new Q(i)},partial_fraction:function(r,n,a,o){var l,p;return t(n)||(n=i.parse(n)),l=new s(0),(p=e.Algebra.PartFrac.partfrac(r,n)).group===v&&p.isLinear()?(p.each((function(e){e.isLinear()||K.integration.stop()})),p.each((function(e){l=i.add(l,K.integrate(e,n,a,o))}))):l=i.add(l,K.integrate(p,n,a,o)),l},get_udv:function(r){var n=[[],[],[],[],[]],t=function(i){var r=i.group;if(r===a){var t=i.fname;e.Utils.in_trig(t)||e.Utils.in_htrig(t)?n[3].push(i):e.Utils.in_inverse_trig(t)?n[1].push(i):t===b?n[0].push(i):K.integration.stop()}else r===m||i.isComposite()&&i.isLinear()||r===v&&i.isLinear()?n[2].push(i):r===y||i.isComposite()&&!i.isLinear()?n[4].push(i):K.integration.stop()};r.group===v?r.each((function(e){t(s.unwrapSQRT(e,!0))})):t(r);for(var o,l=new s(1),p=0;p<5;p++){var u,c=n[p],f=c.length;if(f>0){if(f>1){u=new s(1);for(var g=0;g<f;g++)u=i.multiply(u,c[g].clone())}else u=c[0].clone();o?l=i.multiply(l,u):(o=u).multiplier=o.multiplier.multiply(r.multiplier)}}return[o,l]},trig_sub:function(r,n,t,a,s,o){(s=s||K.integration.decompose_arg(r.clone().toLinear(),n))[3],s[2];var p=s[0],u=s[1];if(u.power.equals(2)&&p.greaterThan(0)){var c=e.Utils.getU(r),f=i.parse(k+l(c)),g=i.parse(q+l(c)+"^2"),m=i.multiply(r.sub(u,f),g),w=K.integrate(m,c,t,a).sub(f,u);return e.Utils.clearU(f),w}},by_parts:function(r,n,t,a){var o,l,p,u,c,f,g,m,w,d,v,y;if(a.previous=a.previous||[],l=(o=K.integration.get_udv(r))[0],p=o[1],v=(u=s.unwrapSQRT(i.expand(K.diff(l.clone(),n)),!0)).clone().stripVar(n),u=i.divide(u,v.clone()),c=K.integrate(p.clone(),n,t||0),y=(f=i.multiply(c.clone(),u)).toString(),-1!==a.previous.indexOf(y)&&e.Utils.in_trig(l.fname)&&p.isE())return a.is_cyclic=!0,new s(1);if(a.previous.push(y),g=i.multiply(l,c),d=f.multiplier.clone(),f.toUnitMultiplier(),(w=i.multiply(K.integrate(f.clone(),n,t,a),v)).multiplier=w.multiplier.multiply(d),m=i.subtract(g,w),a.is_cyclic&&(a.previous.pop(),0===a.previous.length)){m=i.expand(m);var h=new s(0);m.each((function(e){e.contains(n)||(h=i.add(h,e.clone()))})),m=i.divide(i.subtract(m,h.clone()),i.subtract(new s(1),h))}return m},decompose_arg:e.Utils.decompose_fn},integrate:function(o,f,g,h){if(!f){var X=e.Utils.variables(o);1===X.length&&(f=X[0]),f=f||"x"}if(e.Utils.isVector(o)){var Z=new e.Vector([]);return o.each((function(e){Z.elements.push(K.integrate(e,f))})),Z}return isNaN(f)||i.error("variable expected but received "+f),o.isConstant(!0)?i.multiply(o.clone(),i.parse(f)):(h=h||{},e.Utils.block("PARSE2NUMBER",(function(){g=g||0;var X,Z=t(f)?f.toString():f,z=s.unwrapSQRT(o.clone(),!0),W=z.group;try{if(++g>e.Settings.integration_depth&&K.integration.stop("Maximum depth reached. Exiting!"),z.contains(Z,!0)){if(W===m)X=K.integration.poly_integrate(z,Z,g);else if(W===y)if(z.previousGroup===a&&"sqrt"!==z.fname&&z.fname!==n.PARENTHESIS&&K.integration.stop(),z.contains(Z)&&z.previousGroup!==a){if(z.power.contains(Z))K.integration.stop();else(Je=K.diff(z.clone().toLinear(),Z)).contains(Z)&&K.integration.stop(),X=K.integration.poly_integrate(z,Z,g)}else{if((ae=K.diff(z.power.clone(),Z)).contains(Z)){var Y=ae.stripVar(Z);if((se=i.divide(ae.clone(),Y.clone())).group===m&&se.isLinear())return Y.multiplier=Y.multiplier.divide(new r(2)),i.parse(u("({2})*(sqrt(pi)*erf(sqrt(-{0})*{1}))/(2*sqrt(-{0}))",Y,Z,z.multiplier));K.integration.stop()}if(z.isE())ae.isLinear()?X=z:ae.isE()&&ae.power.group===m&&ae.power.power.equals(1)?X=i.multiply(i.symfunction("Ei",[z.power.clone()]),z.power):K.integration.stop();else{var $=i.symfunction(b,[i.parse(z.value)]);X=i.divide(z,$)}X=i.divide(X,ae)}else if(z.isComposite()&&z.isLinear()){var ee=i.parse(z.multiplier);z.toUnitMultiplier(),X=new s(0),z.each((function(e){X=i.add(X,K.integrate(e,Z,g))})),X=i.multiply(ee,X)}else if(W===d)if(z.power.greaterThan(1)&&(z=i.expand(z)),z.power.equals(1))X=new s(0),z.each((function(e){X=i.add(X,K.integrate(e,Z,g))}),!0);else{var ie=Number(z.power);ee=z.multiplier.clone();z.toUnitMultiplier();var re=z.clone().toLinear(),ne=(Ei=K.integration.decompose_arg(re,Z))[3],te=Ei[2],ae=Ei[0],se=Ei[1];if(-1===ie&&se.group!==w&&se.power.equals(2)){var oe=!p(ne)||ne>0;if(se.group===m&&se.power.equals(2)&&oe){var le=function(e){var r=new s(1);return e.each((function(e){r=i.multiply(r,"abs"===e.fname?e.args[0]:e)})),r},pe=ae.clone(),ue=ne.clone();pe=i.pow(pe,new s(.5)),ue=i.pow(ue,new s(.5));$=i.multiply(le(ue),le(pe));var ce=i.symfunction(I,[i.divide(i.multiply(ae,se.toLinear()),$.clone())]);X=i.divide(ce,$)}else if(se.group===m&&se.isLinear())X=i.divide(K.integration.poly_integrate(z),ae);else if(se.power.equals(4)){var fe,ge,me,we,de,ve,ye=l;pe=i.parse(_+ye(ae)+"*"+Z+"^2"),ue=i.parse(_+ye(2)+"*"+ye(ae)+"^"+ye("1/4")+"*"+ye(ne)+"^"+ye("1/4")+"*"+Z),fe=i.parse(_+ye(ne)),Ie=i.add(i.add(pe.clone(),ue.clone()),fe.clone()),ei=i.add(i.subtract(pe,ue),fe),ge=i.parse(_+ye(2)+"*"+ye(ne)+"^"+ye("3/4")),me=i.parse(_+ye(ne)+"*"+ye(ne)+"^"+ye("1/4")+"*"+Z),we=i.parse("2*"+ye(ne)+"*"+_+ye(2)+"*"+ye(ne)+"^"+ye("1/4")),de=i.divide(i.subtract(ge.clone(),me.clone()),i.multiply(we.clone(),ei)),ve=i.divide(i.add(ge,me),i.multiply(we,Ie.clone())),X=i.add(K.integrate(de,Z,g,h),K.integrate(ve,Z,g,h))}else X=K.integration.partial_fraction(z,Z,g)}else if(-.5===ie)if(se.group===m&&se.power.equals(2))if(te.multiplier.lessThan(0)&&!ne.multiplier.lessThan(0))if(ae.negate(),ne.isConstant()&&ae.isConstant()){$=i.symfunction(_,[ae.clone()]);var he=i.symfunction(_,[i.multiply(ae.clone(),ne)]);X=i.divide(i.symfunction(C,[i.divide(te.toLinear(),he)]),$)}else{var be=i.symfunction(_,[ae]),Le=i.multiply(be.clone(),se.clone().toLinear());X=i.divide(i.symfunction(I,[i.divide(Le,i.symfunction(_,[re.clone()]))]),be)}else K.integration.stop();else K.integration.stop();else if(.5===ie&&se.power.equals(2)&&ae.greaterThan(0))K.integration.stop();else if(se.isLinear()&&se.group!==w)X=i.divide(K.integration.poly_integrate(z),ae);else{if(se.power.equals(2)&&ae.greaterThan(0)){var _e,Ue,Se,ke,qe,xe;_e=i.parse(_+l(ae)),Ue=i.parse(_+l(ne)),Se=i.multiply(_e.clone(),Ue.clone()).invert(),ke=i.pow(ne,new s(z.power)),xe=e.Utils.getU(z),Oe=i.multiply(Se,se.clone().toLinear()),qe=i.parse(I+l(Oe));var Te=2*(Math.abs(z.power)-1),Ce=K.integrate(i.parse(S+l(xe)+"^"+Te));return e.Utils.clearU(xe),i.multiply(Ce.sub(xe,qe),ke)}if(z.group===v||z.power.lessThan(0)){ce=z.clone().toLinear();var Ne=e.Algebra.Factor.factor(ce).toString()!==ce.toString();if(e.Algebra.degree(ce,i.parse(Z)).equals(2)&&!Ne)try{var Ie,Me,Ae;Ae=e.Algebra.sqComplete(ce,Z),Oe=e.Utils.getU(ce),Ie=Ae.f.sub(Ae.a,Oe),Me=i.pow(Ie,i.parse(z.power)),X=K.integrate(Me,Oe).sub(Oe,Ae.a)}catch(e){K.integration.stop()}else X=K.integration.partial_fraction(z,Z,g,h)}else X=K.integration.by_parts(z,Z,g,h)}X.multiplier=X.multiplier.multiply(ee)}else if(W===a){var Ee=z.args[0];ee=z.multiplier.clone();z.toUnitMultiplier();ae=(Ei=K.integration.decompose_arg(Ee,Z))[0],se=Ei[1];var Fe=z.fname;if(Fe===b||Fe===C||Fe===N||Fe===I&&se.isLinear()){ie=z.power.toString();if(p(ie)&&(g-=ie),Ee.isComposite()){var Oe=e.Utils.getU(z),Re=(ce=i.pow(i.parse(b+l(Oe)),new s(ie)),K.diff(Ee,Z)),Ge=i.multiply(ce,Re);Ce=K.integrate(Ge,Oe,g,h);X=i.multiply(i.parse(ee),Ce.sub(Oe,Ee))}else X=i.multiply(i.parse(ee),K.integration.by_parts(z,Z,g,h))}else{if(Fe===k&&z.power.lessThan(0))return(ji=z.clone()).power.negate(),ji.fname=T,i.multiply(i.parse(ee),K.integrate(ji,Z,g));if(!ae.contains(Z,!0)&&z.isLinear())if(Fe===L){if((se=i.divide(Ee.clone(),ae.clone())).group!==m||se.power.lessThan(0))K.integration.stop();else if(e.Utils.even(se.power))X=K.integrate(Ee,Z,g);else{var Ve=K.integrate(se,Z,g);Ve.power=Ve.power.subtract(new r(1)),X=i.multiply(i.multiply(i.symfunction(L,[se.toLinear()]),Ve),ae)}}else{var Pe=z.args[0].group,De=K.integration.decompose_arg(Ee,Z);switch((Pe!==d&&Pe!==m&&Pe!==v||!De[1].power.equals(1)||Ee.hasFunc())&&K.integration.stop(),Fe){case S:X=i.symfunction(U,[Ee]);break;case U:(X=i.symfunction(S,[Ee])).negate();break;case k:X=i.parse(u(n.LOG+"(sec({0}))",Ee));break;case q:X=i.parse(u(n.LOG+"(tan({0})+sec({0}))",Ee));break;case x:X=i.parse(u("-"+n.LOG+"(csc({0})+cot({0}))",Ee));break;case T:X=i.parse(u(n.LOG+"(sin({0}))",Ee));break;case F:X=i.symfunction(O,[Ee]);break;case O:X=i.symfunction(F,[Ee]);break;case R:X=i.parse(u(n.LOG+"(cosh({0}))",Ee));break;case M:case A:case E:case D:case B:case H:X=K.integration.by_parts(z,Z,g,h);break;case V:X=i.parse(u("atan(sinh({0}))",Ee));break;case G:X=i.parse(u(n.LOG+"(tanh(({0})/2))",Ee));break;case P:X=i.parse(u(n.LOG+"(sinh({0}))",Ee));break;case"exp":X=K.integrate(i.parse(u("e^({0})",Ee)),Z,g);break;case"S":Ee=z.args[0].clone();var Be=(Pi=K.integration.decompose_arg(Ee,Z))[1],He=Pi[0],Qe=Pi[3];X=i.parse(u("(cos((1/2)*pi*(({1})+({0})*({2}))^2)+pi*(({1})+({0})*({2}))*S(({1})+({0})*({2})))/(({0})*pi)",He,Qe,se));break;case"C":Ee=z.args[0].clone(),Be=(Pi=K.integration.decompose_arg(Ee,Z))[1],He=Pi[0],Qe=Pi[3];X=i.parse(u("(pi*(({1})+({0})*({2}))*C(({1})+({0})*({2}))-sin((1/2)*pi*(({1})+({0})*({2}))^2))/(({0})*pi)",He,Qe,Be));break;case"erf":Ee=z.args[0].clone(),Be=(Pi=K.integration.decompose_arg(Ee,Z))[1],He=Pi[0];X=i.parse(u("e^(-(({2}))^2)/(({0})*sqrt(pi))+(1/({0})+({1}))*erf(({2}))",He,Be,Ee));break;case"sign":X=i.multiply(z.clone(),Ee.clone());break;default:K.integration.stop()}X=i.divide(X,ae)}else if(se.isLinear()){if(Fe===S||Fe===U)if((ie=Number(z.power))<0)z.fname=Fe===U?x:q,z.invert().updateHash(),X=K.integrate(z,Z,g);else{Ee=z.args[0];var je=z.clone(),Xe=z.clone(),Ze=new s((ie-1)/ie),ze=i.multiply(ae.clone(),new s(ie)).invert();je.power=je.power.subtract(new r(1)),Xe.power=Xe.power.subtract(new r(2));var Je=i.symfunction(Fe===S?U:S,[Ee.clone()]);Fe===U&&Je.negate(),X=i.add(i.multiply(i.multiply(ze,je),Je),i.multiply(Ze,K.integrate(i.parse(Xe),Z,g)))}else if(Fe===k||Fe===T){if(z.args[0].isLinear(Z)){Te=z.power.subtract(new r(1)).toString();var Ke=z.clone().toUnitMultiplier(),We=i.parse(u((Fe===T?"-":"")+"1/({2}*{0})*{3}({1})^({0})",Te,Ee,ae,Fe));Ke.power=Ke.power.subtract(new r(2)),Ke.power.equals(0)&&(Ke=i.parse(Ke)),X=i.subtract(We,K.integrate(Ke,Z,g))}}else if(Fe===q||Fe===x){var Ye=z.power.subtract(new r(1)).toString(),$e=z.power.subtract(new r(2)).toString(),ei=Fe===q?k:T,ii=(Ke=z.clone().toUnitMultiplier(),u((Fe===x?"-":"")+"1/({0}*{1})*{4}({3})^({2})*{5}({3})",ae,Ye,$e,Ee,Fe,ei));We=i.parse(ii);Ke.power=Ke.power.subtract(new r(2)),Ke.power.equals(0)&&(Ke=i.parse(Ke)),X=i.add(We,i.multiply(new s($e/Ye),K.integrate(Ke,Z,g)))}else Fe!==O&&Fe!==F||!z.power.equals(2)?K.integration.stop():X=K.integrate(z.fnTransform(),Z,g)}else K.integration.stop();X.multiplier=X.multiplier.multiply(ee)}}else if(W===w)X=K.integration.partial_fraction(z,Z,g);else if(W===v){z.getDenom().group===m&&(z=i.expand(z));var ri=z.stripVar(Z),ni=i.divide(z.clone(),ri.clone());if(ri.contains(Z)&&(ni=i.multiply(ni,ri),ri=new s(1)),ni.group!==v){if(ni.equals(1))return K.integrate(i.expand(z),Z,g);ni.clone().toLinear().isPoly(!0)&&e.Utils.variables(ni).length>1&&(ni=e.Algebra.Factor.factor(ni)),X=K.integrate(ni,Z,g)}else{var ti=ni.collectSymbols().sort((function(e,i){return e.group===i.group?Number(e.power)===Number(i.power)?e<i?1:-1:i.power-e.power:i.group-e.group})).map((function(e){var r=s.unwrapSQRT(e,!0);return"exp"===r.fname?i.parse(u("({1})*e^({0})",r.args[0],r.multiplier)):r})),ai=ti.length;if(z.power<0){if(2===ai)return K.integrate(i.expand(z),Z,g,h)}else if(2===ai){try{X=K.integration.u_substitution(ti,Z)}catch(e){}if(!X){var si=ti[0].group,oi=ti[1].group,li=ti[0],pi=ti[1],ui=li.fname,ci=pi.fname;if(z=i.multiply(li.clone(),pi.clone()),si===a&&oi===a)if(ui===b||ci===b)X=K.integration.by_parts(z.clone(),Z,g,h);else{ti.sort((function(e,i){return i.fname>e.fname}));var fi=li.args[0];(!fi.isLinear()||fi.group!==d&&fi.group!==v&&fi.group!==m)&&K.integration.stop(),se=(Ei=K.integration.decompose_arg(fi,Z))[1],ae=Ei[0],se.isLinear()||K.integration.stop();var gi=pi.args[0];if(fi.equals(gi))if(ui===U&&ci===S||ui===S&&ci===U)if(li.power.lessThan(0)&&K.integration.stop(),ui===U&&li.power.add(pi.power).equals(0))li.fname=k,li.updateHash(),X=K.integrate(li,Z,g);else if(c(li.power)&&ci===S&&pi.power.lessThan(0)){Te=Number(li.power)/2;var mi=i.parse(u("(1-cos({0})^2)^({1})",li.args[0],Te));X=K.integrate(i.expand(i.multiply(mi,pi.clone())),Z,g,h)}else if(c(li.power)&&ci===U&&pi.power.lessThan(0)){Te=Number(li.power)/2,mi=i.parse(u("(1-sin({0})^2)^({1})",li.args[0],Te));X=K.integrate(i.expand(i.multiply(mi,pi.clone())),Z,g,h)}else{var wi=e.Utils.even(li.power),di=e.Utils.even(pi.power);if(X=new s(0),wi&&di){var vi=function(e){var r,n=e.power/2;return r=e.fname===S?"((1/2)+(cos(2*("+e.args[0]+"))/2))^"+n:"((1/2)-(cos(2*("+e.args[0]+"))/2))^"+n,i.parse(r)};ae=vi(li),ne=vi(pi),Je=i.multiply(ae,ne);return(ji=i.expand(Je)).each((function(e){X=i.add(X,K.integrate(e,Z,g))})),i.multiply(X,ri)}wi?(Oe=li,Ke=pi):(Oe=pi,Ke=li);var yi=Oe.fname===S?-1:1,hi=((Te=Ke.power)-1)/2,bi=i.parse("(1-"+Oe.fname+e.Utils.inBrackets(fi)+"^2)^"+hi);(ji=i.expand(i.multiply(new s(yi),i.multiply(Oe.clone(),bi)))).each((function(e){X=i.add(X,K.integration.poly_integrate(e.clone()))}))}else if(ui===q&&ci===k&&se.isLinear()&&pi.isLinear())X=i.parse(u("sec({0})^({1})/({1})",li.args[0],li.power));else if(ui===k&&ci===q&&se.isLinear())if(li.isLinear()&&pi.isLinear())X=i.divide(i.symfunction(q,[fi.clone()]),ae);else if(c(li.power)){ie=Number(li.power)/2,Je=i.parse(u("(sec({0})^2-1)^({1})",li.args[0],ie));X=K.integrate(i.expand(i.multiply(Je,pi)),Z,g)}else K.integration.stop();else if(ui===q&&ci===S)li.fname=S,li.invert().updateHash(),X=K.integrate(i.multiply(li,pi),Z,g);else if(ui===U&&ci===x)pi.fname=U,pi.invert().updateHash(),X=K.integrate(i.multiply(li,pi),Z,g);else if(ui!==k||ci!==S&&ci!==U||!pi.power.lessThan(0)){Je=i.multiply(li.fnTransform(),pi.fnTransform());X=K.integrate(i.expand(Je),Z,g)}else{var Je=i.multiply(li.fnTransform(),pi);X=K.integrate(i.expand(Je),Z,g)}else if(ui!==U&&ui!==S||ci!==U&&ci!==S)K.integration.stop();else if(li.isLinear()&&pi.isLinear())if(li.args[0].isLinear()&&pi.args[0].isLinear()){ci===U?(te=li.args[0],Di=pi.args[0]):(Di=li.args[0],te=pi.args[0]),ce=i.parse(u("(sin(({1})+({0}))+sin(({1})-({0})))/2",te.toString(),Di.toString())),X=K.integrate(ce,Z,g)}else{var Li=J(ti);X=K.integrate(i.expand(Li),Z,g)}else{Li=new s(1);ti.map((function(e){var r=e.fnTransform();Li=i.multiply(Li,r)}));Je=i.expand(Li);(X=K.integrate(Je,Z,g)).hasIntegral()&&(X=K.integrate(J(Li.collectSymbols()),Z,g))}}else if(si===a&&oi===m){var _i=li.isLinear();if(li.fname===S&&_i&&pi.power.equals(-1))X=i.symfunction("Ci",[li.args[0]]);else if(li.fname===S&&pi.power.equals(-1))X=K.integrate(i.multiply(li.fnTransform(),pi.clone()),Z,g);else if(li.fname===O&&_i&&pi.power.equals(-1))X=i.symfunction("Chi",[li.args[0]]);else if(li.fname===O&&pi.power.equals(-1))X=K.integrate(i.multiply(li.fnTransform(),pi.clone()),Z,g);else if(li.fname===U&&_i&&pi.power.equals(-1))X=i.symfunction("Si",[li.args[0]]);else if(li.fname===U&&pi.power.equals(-1))X=K.integrate(i.multiply(li.fnTransform(),pi.clone()),Z,g);else if(li.fname===F&&_i&&pi.power.equals(-1))X=i.symfunction("Shi",[li.args[0]]);else if(li.fname===F&&pi.power.equals(-1))X=K.integrate(i.multiply(li.fnTransform(),pi.clone()),Z,g);else if(li.fname===b&&pi.power.equals(-1))X=K.integration.poly_integrate(li,Z,g);else if("erf"===li.fname){if(pi.power.equals(1)){He=(Pi=K.integration.decompose_arg(li.args[0],Z))[0],Be=Pi[1],Ee=li.args[0].toString();X=i.parse(u("(e^(-(({2}))^2)*(sqrt(pi)*e^((({2}))^2)*(2*({0})^2*({1})^2-3)*erf(({2}))+2*({0})*({1})-2))/(4*sqrt(pi)*({0})^2)",He,Be,Ee))}}else X=K.integration.by_parts(z,Z,g,h)}else if(si===y&&oi===m){se=ui===b?K.integration.decompose_arg(li.args[0],Z)[1]:null;X=li.isE()&&(li.power.group===m||li.power.group===v)&&pi.power.equals(-1)?i.symfunction("Ei",[li.power.clone()]):ui===b&&se.value===pi.value?K.integration.poly_integrate(li,Z,g):K.integration.by_parts(z,Z,g,h)}else if(si===w&&oi===m){if(pi.value===li.value&&li.power.equals(-1)){var Ui=Math.min.apply(null,e.Utils.keys(li.symbols)),Si=Math.min(Ui,pi.power),ki=pi.clone();ki.power=new r(Si),pi=i.divide(pi,ki.clone());Je=new s(0);li.each((function(e){Je=i.add(Je,i.divide(e.clone(),ki.clone()))})),Je.multiplier=li.multiplier,z=i.divide(pi,Je)}else z=i.expand(z);X=K.integration.partial_fraction(z,Z,g)}else if(si===d&&oi===m){ce=li.clone().toLinear();var qi=e.Algebra.degree(ce,i.parse(Z)).equals(1);if(li.power.equals(-.5)){ae=(Ei=K.integration.decompose_arg(li.clone().toLinear(),Z))[0].negate(),se=Ei[1],ne=Ei[3];var xi=Number(li.power),Ti=Number(pi.power);if(p(Ti)&&e.Utils.even(Ti)&&se.power.equals(2)){var Ci=i.divide(i.multiply(i.pow(ne.clone(),new s(2)),i.symfunction(_,[i.divide(ne.clone(),ae.clone())])),i.pow(ae.clone(),new s(2)));Ci=i.multiply(Ci,i.symfunction(_,[ne]).invert());var Ni=i.parse("sin(u)");Ni.power=Ni.power.multiply(pi.power);Ce=K.integrate(Ni,"u",g);var Ii=i.parse("asin(sqrt("+ae+"/"+ne+")*"+Z+")");X=i.multiply(Ci,Ce.sub(new s("u"),Ii))}else if(-.5===xi){var Mi=function(e,r){var n=i.parse(K.integrate(e,Z,g,h).sub(Z,u(r,Z)));if(!n.hasIntegral())return n};-1===Ti?X=Mi(i.expand(i.expand(i.pow(i.multiply(li.invert(),pi.invert()),new s(2)))).invert(),"sqrt(1-1/({0})^2)"):-2===Ti&&(X=Mi(i.sqrt(i.expand(i.divide(i.pow(z,new s(2)).invert(),i.pow(new s(Z),new s(2))).negate())).invert(),"sqrt(1-1/({0})^2)"))}}else if(li.power.equals(-1)&&pi.isLinear()&&qi)X=K.integration.partial_fraction(z,Z,g);else if(!li.power.lessThan(0)&&p(li.power)){var Ai=i.expand(li);X=new s(0),Ai.each((function(e){e.group===w?e.each((function(e){X=i.add(X,K.integrate(i.multiply(pi.clone(),e),Z,g))})):X=i.add(X,K.integrate(i.multiply(pi.clone(),e),Z,g))}))}else if(li.power.lessThan(-2))X=K.integration.by_parts(z,Z,g,h);else if(li.power.lessThan(0)&&pi.power.greaterThan(1)){var Ei;ae=(Ei=K.integration.decompose_arg(li.clone().toLinear(),Z))[0].negate(),se=Ei[1],ne=Ei[3],re=li.clone().toLinear();if(se.group!==w&&se.isLinear()){ie=Number(pi.power),Oe=new s(Re="_u_");var Fi=i.expand(i.divide(i.pow(i.subtract(Oe.clone(),ne.clone()),new s(ie)),Oe.clone())),Oi={};Oi[Re]=re;var Ri=i.parse(Fi,Oi);X=K.integrate(Ri,Z,0)}else if(pi.power.greaterThan(se.power)||pi.power.equals(se.power)){var Gi=new e.Algebra.Classes.Factors;li=e.Algebra.Factor.coeffFactor(li.invert(),Gi);var Vi=e.Algebra.divide(pi,li);Vi.group!==v?(X=new s(0),Vi.each((function(e){X=i.add(X,K.integrate(e,Z,g))})),Gi.each((function(e){X=i.divide(X,e)})),X=i.expand(X)):X=K.integration.by_parts(z,Z,g,h)}else X=K.integration.partial_fraction(z,Z,g)}else if(li.power.den.equals(2)){ae=(Pi=K.integration.decompose_arg(li.clone().toLinear(),Z))[3],se=Pi[1],ne=Pi[0];var Pi,Di=Pi[2];if(se.power.equals(2)&&ne.lessThan(0)){ae.equals(1)||(ri=i.multiply(ri,i.pow(ae,new s(2))));Oe=Z,Ci=i.divide(i.pow(ne.clone().negate(),new s(.5)),i.pow(ae,new s(.5))),Re=i.symfunction(S,[new s(Oe)]);var Bi=i.pow(i.symfunction(S,[new s(Oe)]),new s(li.power.num)),Hi=i.pow(i.symfunction(U,[new s(Oe)]),new s(pi.power)),Qi=i.multiply(i.multiply(Bi,Re),Hi);Ce=K.integrate(Qi,Oe,g);X=Ce.sub(Oe,i.symfunction(C,[i.multiply(new s(Z),Ci)]))}else X=K.integration.partial_fraction(z,Z,g,h)}else qi&&(X=K.integration.partial_fraction(z,Z,g))}else if(li.isComposite()&&pi.isComposite())if(X=new s(0),li.power.greaterThan(0)&&pi.power.greaterThan(0)){var ji;(ji=i.expand(z)).each((function(e){X=i.add(X,K.integrate(e,Z,g))}),!0)}else{xi=Number(li.power),Ti=Number(pi.power);if(xi<0&&Ti>0){Je=li;li=pi,pi=Je}-1===xi&&-1===Ti?X=K.integration.partial_fraction(z,Z):li.each((function(e){var r=i.multiply(e,pi.clone()),n=K.integrate(r,Z,g);X=i.add(X,n)}))}else if(si===d&&ti[0].power.greaterThan(0))li=i.expand(li),X=new s(0),li.each((function(e){X=i.add(X,K.integrate(i.multiply(e,pi.clone()),Z,g))}),!0);else if(si===a&&oi===y&&e.Utils.in_htrig(li.fname))li=li.fnTransform(),X=K.integrate(i.expand(i.multiply(li,pi)),Z,g);else if(si===a&&oi===d||oi===a&&si===d){if(oi===a&&si===d){Je=li;li=pi,pi=Je}var Xi,Zi,zi;if(Re=s.unwrapSQRT(K.diff(li.clone(),Z),!0),Xi=s.unwrapSQRT(pi,!0),Re.power.equals(Xi.power)){if(ie=new s(pi.power),Zi=Re.clone().toLinear(),zi=pi.clone().toLinear(),(Ze=e.Algebra.divide(Zi.toLinear(),zi)).isConstant()){var Ji=i.pow(Ze,ie.negate());X=i.multiply(Ji,K.integration.poly_integrate(li.clone()))}}else X=K.integration.by_parts(z,Z,g,h)}else{var Ki=li.clone().toLinear(),Wi=pi.clone().toLinear();X=si===y&&oi===y&&li.power.contains(Z)&&pi.power.contains(Z)&&!Ki.contains(Z)&&!Wi.contains(Z)?i.parse(u("(({0})^(({2})*({4}))*({1})^(({3})*({4})))/(log(({0})^({2}))+log(({1})^({3})))",Ki.toString(),Wi.toString(),li.power.multiplier.toString(),pi.power.multiplier.toString(),Z)):K.integration.by_parts(z,Z,g,h)}}}else if(3===ai&&(ti[2].group===m&&ti[2].power.lessThan(2)||ti[0].group===d)){var Yi=ti[0];if(Yi.group===d){Yi.power.greaterThan(1)&&(Yi=i.expand(Yi));Ke=i.multiply(ti[1],ti[2]);X=new s(0),Yi.each((function(e){var r=i.multiply(e,Ke.clone()),n=K.integrate(r,Z,g);X=i.add(X,n)}),!0)}else X=K.integration.by_parts(z,Z,g,h)}else if(j(ti)){Je=new s(1);var $i=0;for(ai=ti.length;$i<ai;$i++)Je=i.multiply(Je,ti[$i].fnTransform());Je=i.expand(Je),X=K.integrate(Je,Z,g)}else{Li=J(ti);X=K.integrate(i.expand(Li),Z,g)}}X=i.multiply(X,ri)}}else X=i.multiply(z.clone(),i.parse(Z));if(X)return X}catch(i){if(!(i instanceof Q||i instanceof e.exceptions.DivisionByZero))throw i}return i.symfunction("integrate",[o,f])}),!1))},defint:function(r,n,t,a){a=a||"x";var o,l,p=function(e,r,n){try{return i.parse(e,r)}catch(i){return K.Limit.limit(e,a,n)}},u=e.Utils.variables(r),c=r.hasTrig();if(1!==u.length||a||(a=u[0]),c||(l=K.integrate(r,a)),c||l.hasIntegral())if(1===u.length&&n.isConstant()&&t.isConstant()){var f=e.Utils.build(r);o=new s(e.Math2.num_integrate(f,Number(n),Number(t)))}else o=i.symfunction("defint",[r,n,t,a]);else{var g,m,w={},d={};w[a]=t,d[a]=n,g=p(l,w,t),m=p(l,d,n),o=i.subtract(g,m)}return o},Limit:{interval:function(e,r){return i.parse(u("[{0}, {1}]",e,r))},diverges:function(){return K.Limit.interval("-Infinity","Infinity")},divide:function(r,t,a,o,l){if(!(l++>n.max_lim_depth)){r.clone();var p=t.clone();if(t.fname===L){var u=r.sign(),c=o.sign();if(o.isInfinity)return i.multiply(new s(u),new s(c));if(o.equals(0)){var g=i.parse(r.multiplier),m=i.parse(t.multiplier);return i.divide(i.multiply(g,K.Limit.interval("-1","1")),m)}K.Limit.diverges()}var w=function(i){if(e.Utils.isVector(i)){for(var r=0;r<i.elements.length;r++)if(!i.elements[r].isInfinity)return!1;return!0}return i.isInfinity},d=function(i,r){return!e.Utils.isVector(i)&&i.equals(r)};do{var v=f(K.Limit.limit(r.clone(),a,o,l)),y=f(K.Limit.limit(t.clone(),a,o,l)),h=w(v)&&w(y)||d(v,0)&&d(y,0);if(h){var b=K.diff(r.clone(),a),_=K.diff(t.clone(),a),U=i.expand(i.divide(b,_));r=U.getNum(),t=U.getDenom()}}while(h);var S=y.equals(0),k=Number(p.power);return o.isConstant(!0)&&S?s.infinity(e.Utils.even(k)&&v.lessThan(0)?-1:void 0):S?K.Limit.diverges():i.divide(v,y)}},rewriteToLog:function(e){var r=e.power.clone();return e.toLinear(),i.pow(new s("e"),i.multiply(r,i.symfunction(n.LOG+"",[e])))},getSubbed:function(e,i,r){var n;e.group===y&&(e=K.rewriteToLog(e));try{n=e.sub(i,r)}catch(i){n=e}return n},isInterval:function(i){return e.Utils.isVector(i)},isConvergent:function(e){return!(K.Limit.isInterval(e)&&e.elements[0].isInfinity&&e.elements[1].isInfinity||e.containsFunction("limit"))},limit:function(r,t,o,l){if(r.isLinear()&&r.isComposite()){var p=new s(0);return r.each((function(e){p=i.add(p,K.Limit.limit(e,t,o,l))}),!0),p}if(r=e.Algebra.Simplify.simplify(r),l=l||1,!(l++>n.max_lim_depth)){var c=i.parse(r.multiplier);r.toUnitMultiplier();try{var g;if(r.isConstant(!0))g=r;else{var w={};w[t]=o;try{var d=i.parse(r.sub(t,o),w);(d.isConstant(!0)||d.isInfinity)&&(g=d)}catch(e){}if(!g){var h=r.getNum(),L=r.getDenom();if(L.isConstant(!0)){if(r.group===y){var _=r.clone().toLinear(),q=(r.power.clone(),_.getNum()),x=_.getDenom(),T=e.Utils.decompose_fn(x,t,!0);if(q.group===m&&q.multiplier.isOne()&&T.ax.group===m&&T.b.isConstant(!0)&&T.a.isOne()&&T.b.isConstant(!0))g=i.parse(u("(1/e^({0}))",T.b));else{var C=K.Limit.rewriteToLog(r.clone()),N=C.power.clone(),I=C.clone().toLinear(),M=K.Limit.limit(I,t,o,l),A=K.Limit.limit(N,t,o,l);g=i.pow(M,A)}}else if(r.group===a&&1===r.args.length){var E,F=K.Limit.limit(r.args[0],t,o,l);if(e.Utils.isVector(F))return g=F.map((function(e){return r.clone().args[0]=e,K.Limit.limit(i.symfunction(r.fname,[e]),t,o,l)})),i.multiply(c,g);if(F.isConstant(!0)){var O=i.symfunction(r.fname,[F]);try{f(O),E=!0}catch(e){E=!1}}if(E)g=O;else if(K.Limit.isConvergent(F))if(r.fname===b)switch(F.toString()){case"0":g=s.infinity().negate();break;case"Infinity":case"-Infinity":g=s.infinity()}else if(r.fname!==S&&r.fname!==U||!o.isInfinity){if(r.fname===k){var R=r.args[0],G=R.getNum(),V=R.getDenom(),P=G.toUnitMultiplier();(o.isInfinity||P.equals("pi")&&V.equals(2))&&(g=divergent())}else if(r.fname===n.FACTORIAL&&F.isInfinity)return s.infinity()}else g=K.Limit.interval(-1,1)}else if(r.group===m){if(r.power>0)return i.parse(r,w);g=e.Utils.even(r.power)?s.infinity():K.Limit.diverges()}else if(r.group===v){var D,B;_=(j=r.collectSymbols().sort((function(e,i){return e.group-i.group}))).pop();for(D=f(K.Limit.limit(_,t,o,l));j.length;){var H=j.pop();B=f(K.Limit.limit(H,t,o,l)),D.isInfinity||!K.Limit.isConvergent(D)&&B.equals(0)||D.equals(0)&&K.Limit.isConvergent(B)?(H.containsFunction(b)&&(H=[_,_=H][0]),H.invert(),D=D.isInfinity&&B.isInfinity?s.infinity():K.Limit.divide(_,H,t,o,l)):(D=i.multiply(D,B),_=i.multiply(_,H))}g=D}else if(r.isComposite()){var Q;r.isLinear()||(r=i.expand(r)),g=new s(0);for(var j=r.collectSymbols().sort((function(e,i){return i.group-e.group})),X=[],Z=new s(0),z=0,J=j.length;z<J;z++){(W=j[z].clone()).group===a||W.group===v&&W.hasFunc()?Z=i.add(Z,W):X.push(W)}X.unshift(Z),1!==X.length&&(j=X);for(z=0,J=j.length;z<J;z++){var W=j[z];try{Q=K.Limit.limit(W,t,o,l)}catch(e){Q=K.Limit.diverges()}try{g=i.add(g,Q)}catch(e){if(l++>n.max_lim_depth)return;g=K.Limit.limit(K.diff(r,t),t,o,l)}}}}else g=K.Limit.divide(h,L,t,o,l)}}g||(g=i.symfunction("limit",[r,t,o]))}catch(e){g=i.symfunction("limit",[r,t,o])}return i.multiply(c,g)}}},Fresnel:{S:function(e){return e.isConstant(!0)?K.defint(i.parse("sin(pi*x^2/2)"),s(0),e,"x"):i.symfunction("S",arguments)},C:function(e){return e.isConstant(!0)?K.defint(i.parse("cos(pi*x^2/2)"),s(0),e,"x"):i.symfunction("C",arguments)}}};nerdamer.register([{name:"diff",visible:!0,numargs:[1,3],build:function(){return K.diff}},{name:"sum",visible:!0,numargs:4,build:function(){return K.sum}},{name:"product",visible:!0,numargs:4,build:function(){return K.product}},{name:"integrate",visible:!0,numargs:[1,2],build:function(){return K.integrate}},{name:"defint",visible:!0,numargs:[3,4],build:function(){return K.defint}},{name:"S",visible:!0,numargs:1,build:function(){return K.Fresnel.S}},{name:"C",visible:!0,numargs:1,build:function(){return K.Fresnel.C}},{name:"limit",visible:!0,numargs:[3,4],build:function(){return K.Limit.limit}}]),nerdamer.updateAPI()}();
